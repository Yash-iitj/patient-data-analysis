2025-04-15 14:00:30,473 - __main__ - INFO - Starting pipeline with fixed parameters
2025-04-15 14:00:30,473 - __main__ - INFO - Running big data pipeline with deep learning
2025-04-15 14:00:30,473 - __main__ - INFO - Running big data pipeline with deep learning
2025-04-15 14:00:33,020 - src.big_data_processor - INFO - Deep learning is enabled for BigDataProcessor
2025-04-15 14:00:33,020 - src.big_data_processor - INFO - Loading big data files...
2025-04-15 14:00:33,052 - src.big_data_processor - INFO - Loaded 10600 patients
2025-04-15 14:00:33,168 - src.big_data_processor - INFO - Loaded 53034 encounters
2025-04-15 14:00:33,262 - src.big_data_processor - INFO - Loaded 106169 conditions
2025-04-15 14:00:33,262 - src.big_data_processor - INFO - Preprocessing data...
2025-04-15 14:00:33,348 - src.big_data_processor - INFO - Preprocessing complete
2025-04-15 14:00:33,349 - src.big_data_processor - INFO - Identifying patient drop-offs...
2025-04-15 14:01:03,263 - src.big_data_processor - INFO - Identified 5795 drop-offs out of 10531 patients (55.03%)
2025-04-15 14:01:03,265 - src.big_data_processor - INFO - Extracting features...
2025-04-15 14:01:03,326 - src.big_data_processor - INFO - Extracted 41 features for 10531 patients
2025-04-15 14:01:03,334 - enhanced_processor - INFO - Training set: 8424 samples, Testing set: 2107 samples
2025-04-15 14:01:03,334 - enhanced_processor - INFO - Drop-off rate in training set: 55.03%
2025-04-15 14:01:03,334 - enhanced_processor - INFO - Drop-off rate in testing set: 55.01%
2025-04-15 14:01:03,334 - enhanced_processor - INFO - Training logistic_regression...
2025-04-15 14:01:03,584 - enhanced_processor - WARNING - Could not calculate feature importance for logistic_regression: The 'X' parameter of permutation_importance must be an array-like. Got <2107x9124 sparse matrix of type '<class 'numpy.float64'>'
	with 69525 stored elements in Compressed Sparse Row format> instead.
2025-04-15 14:01:03,584 - enhanced_processor - INFO - logistic_regression results:
2025-04-15 14:01:03,584 - enhanced_processor - INFO -   - Accuracy: 0.5439
2025-04-15 14:01:03,584 - enhanced_processor - INFO -   - Precision: 0.5784
2025-04-15 14:01:03,584 - enhanced_processor - INFO -   - Recall: 0.6299
2025-04-15 14:01:03,584 - enhanced_processor - INFO -   - F1 Score: 0.6031
2025-04-15 14:01:03,584 - enhanced_processor - INFO -   - ROC AUC: 0.5633
2025-04-15 14:01:03,584 - enhanced_processor - INFO -   - PR AUC: 0.6130
2025-04-15 14:01:03,584 - enhanced_processor - INFO - Classification Report for logistic_regression:
2025-04-15 14:01:03,588 - enhanced_processor - INFO -               precision    recall  f1-score   support

       False       0.49      0.44      0.46       948
        True       0.58      0.63      0.60      1159

    accuracy                           0.54      2107
   macro avg       0.54      0.53      0.53      2107
weighted avg       0.54      0.54      0.54      2107

2025-04-15 14:01:03,588 - enhanced_processor - INFO - Confusion Matrix for logistic_regression:
2025-04-15 14:01:03,588 - enhanced_processor - INFO - [[416 532]
 [429 730]]
2025-04-15 14:01:03,822 - enhanced_processor - INFO - Training random_forest...
2025-04-15 14:01:08,015 - enhanced_processor - INFO - random_forest results:
2025-04-15 14:01:08,015 - enhanced_processor - INFO -   - Accuracy: 0.5643
2025-04-15 14:01:08,015 - enhanced_processor - INFO -   - Precision: 0.5808
2025-04-15 14:01:08,015 - enhanced_processor - INFO -   - Recall: 0.7472
2025-04-15 14:01:08,015 - enhanced_processor - INFO -   - F1 Score: 0.6536
2025-04-15 14:01:08,015 - enhanced_processor - INFO -   - ROC AUC: 0.5831
2025-04-15 14:01:08,015 - enhanced_processor - INFO -   - PR AUC: 0.6301
2025-04-15 14:01:08,015 - enhanced_processor - INFO - Classification Report for random_forest:
2025-04-15 14:01:08,019 - enhanced_processor - INFO -               precision    recall  f1-score   support

       False       0.52      0.34      0.41       948
        True       0.58      0.75      0.65      1159

    accuracy                           0.56      2107
   macro avg       0.55      0.54      0.53      2107
weighted avg       0.56      0.56      0.55      2107

2025-04-15 14:01:08,019 - enhanced_processor - INFO - Confusion Matrix for random_forest:
2025-04-15 14:01:08,019 - enhanced_processor - INFO - [[323 625]
 [293 866]]
2025-04-15 14:01:08,145 - enhanced_processor - INFO - Training gradient_boosting...
2025-04-15 14:01:15,269 - enhanced_processor - INFO - gradient_boosting results:
2025-04-15 14:01:15,269 - enhanced_processor - INFO -   - Accuracy: 0.5619
2025-04-15 14:01:15,269 - enhanced_processor - INFO -   - Precision: 0.5885
2025-04-15 14:01:15,269 - enhanced_processor - INFO -   - Recall: 0.6773
2025-04-15 14:01:15,269 - enhanced_processor - INFO -   - F1 Score: 0.6298
2025-04-15 14:01:15,269 - enhanced_processor - INFO -   - ROC AUC: 0.5828
2025-04-15 14:01:15,269 - enhanced_processor - INFO -   - PR AUC: 0.6347
2025-04-15 14:01:15,269 - enhanced_processor - INFO - Classification Report for gradient_boosting:
2025-04-15 14:01:15,272 - enhanced_processor - INFO -               precision    recall  f1-score   support

       False       0.52      0.42      0.46       948
        True       0.59      0.68      0.63      1159

    accuracy                           0.56      2107
   macro avg       0.55      0.55      0.55      2107
weighted avg       0.56      0.56      0.56      2107

2025-04-15 14:01:15,272 - enhanced_processor - INFO - Confusion Matrix for gradient_boosting:
2025-04-15 14:01:15,272 - enhanced_processor - INFO - [[399 549]
 [374 785]]
2025-04-15 14:01:15,400 - enhanced_processor - INFO - Deep learning is enabled, training TensorFlow model...
2025-04-15 14:01:15,400 - src.big_data_processor - INFO - Training deep learning model with TensorFlow...
2025-04-15 14:01:26,754 - src.big_data_processor - INFO - Deep learning model results:
2025-04-15 14:01:26,754 - src.big_data_processor - INFO -   - Accuracy: 0.5486
2025-04-15 14:01:26,754 - src.big_data_processor - INFO -   - Precision: 0.5674
2025-04-15 14:01:26,755 - src.big_data_processor - INFO -   - Recall: 0.7550
2025-04-15 14:01:26,755 - src.big_data_processor - INFO -   - F1 Score: 0.6479
2025-04-15 14:01:26,755 - src.big_data_processor - INFO -   - ROC AUC: 0.5561
2025-04-15 14:01:26,755 - src.big_data_processor - INFO -   - PR AUC: 0.6157
2025-04-15 14:01:26,755 - src.big_data_processor - INFO - Classification Report for deep learning model:
2025-04-15 14:01:26,758 - src.big_data_processor - INFO -               precision    recall  f1-score   support

       False       0.50      0.30      0.37       948
        True       0.57      0.75      0.65      1159

    accuracy                           0.55      2107
   macro avg       0.53      0.53      0.51      2107
weighted avg       0.54      0.55      0.52      2107

2025-04-15 14:01:26,758 - src.big_data_processor - INFO - Confusion Matrix for deep learning model:
2025-04-15 14:01:26,758 - src.big_data_processor - INFO - [[281 667]
 [284 875]]
2025-04-15 14:01:26,996 - enhanced_processor - INFO - Deep learning model training complete
2025-04-15 14:01:26,997 - enhanced_processor - INFO - Best model: random_forest with ROC AUC = 0.5831
2025-04-15 14:01:26,998 - src.big_data_processor - INFO - Pipeline complete
2025-04-15 14:01:26,998 - __main__ - INFO - Big data pipeline complete. Results:
2025-04-15 14:01:26,998 - __main__ - INFO -   - accuracy: 0.5547
2025-04-15 14:01:26,998 - __main__ - INFO -   - precision: 0.5788
2025-04-15 14:01:26,998 - __main__ - INFO -   - recall: 0.7023
2025-04-15 14:01:26,998 - __main__ - INFO -   - f1_score: 0.6336
2025-04-15 14:01:26,998 - __main__ - INFO -   - roc_auc: 0.5713
2025-04-15 14:01:26,998 - __main__ - INFO -   - pr_auc: 0.6234
2025-04-15 14:01:27,006 - __main__ - INFO - Generating comparison plots
2025-04-15 14:01:28,043 - __main__ - INFO - Pipeline completed successfully
